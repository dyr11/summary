<!Doctype>
<html>
 <head>
   <title>瀑布流布局</title>
   <meta charset="utf-8" />
  <style type="text/css">
    *{padding: 0;margin:0;}
    #main{
        position: relative;
    }
    .box{
        padding: 15px 0 0 15px;
        float:left;
    }
    .pin{
        padding: 10px;
        border:1px solid #ccc;
        box-shadow: 0 0 6px #ccc;
        border-radius: 5px;
    }
    .pin img{
        width:162px;
        height:auto;
    }
</style>
 </head>
 <body>
     <div id="main">
 		<div class="box">
 			<div class="pic">
 				<img src="images/0.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/1.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/2.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/3.jpg" />
 			</div>
 		</div>
  		<div class="box">
 			<div class="pic">
 				<img src="images/4.jpg" />
 			</div>
 		</div>
  		<div class="box">
 			<div class="pic">
 				<img src="images/5.jpg" />
 			</div>
 		</div>
  		<div class="box">
 			<div class="pic">
 				<img src="images/6.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/7.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/8.jpg" />
 			</div>
 		</div>
 		<div class="box">
 			<div class="pic">
 				<img src="images/9.jpg" />
 			</div>
 		</div>
  		<div class="box">
 			<div class="pic">
 				<img src="images/10.jpg" />
 			</div>
 		</div>
	</div>
 </body>
</html>
<script type="text/javascript">
var list;
 window.onload=function(){
  //alert("adsead");
     waterfall('main','box');
}
function waterfall(parent,box){
  var oParent=document.getElementById(parent);
  var oBoxs=getByClass(oParent,box);
  var window_width=document.documentElement.clientWidth;
  var cols=Math.floor(window_width/oBoxs[0].offsetWidth);
  console.log("window_width:"+window_width);
  console.log("oBoxs[0].offsetWidth:"+oBoxs[0].offsetWidth);
  console.log("cols:"+cols);
  list=[];
for(var i=0;i<oBoxs.length;i++){
    if(i<cols){
       // 将图片的高度值添加到数组中
       list.push(oBoxs[i].offsetHeight);
    }else{
      // 求最小值和最小值的索引
      var min=Math.min.apply(null,list);
      console.log("min:"+min);
      var index=getMinhIndex(list,min);
      console.log("index:"+index);
      

// 计算及定义图片出现的位置
      oBoxs[i].style.position='absolute';
      oBoxs[i].style.left=oBoxs[index].offsetLeft+'px';
      console.log("oBoxs[index].offsetWidth:"+oBoxs[index].offsetWidth);
      oBoxs[i].style.top=min+"px";
      //oBoxs[i].style.offsetWidth=oBoxs[0].offsetWidth;
      
      list[index]+=oBoxs[i].offsetHeight;
      // 改变数组值
     
    }
  }
}
function getByClass(parent,clsName){
  var boxArr=new Array(), 
      oElements=parent.getElementsByTagName('*');
  for(var i=0;i<oElements.length;i++){
    if(oElements[i].className==clsName){
      boxArr.push(oElements[i]);
    }
  }
  return boxArr;
}


// 求值在数组中的索引,arr接收的是数组，val接收的是判断的值
function getMinhIndex(arr,val){
  for (var i = 0; i < arr.length; i++) {
    if(arr[i]==val){
      return i;
    }
  };
}

</script>